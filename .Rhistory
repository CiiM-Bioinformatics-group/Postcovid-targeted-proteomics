library(dplyr)
library(magrittr)
library(ggplot2)
library(ggsci)
library(ggpubr)
rm(list = ls())
setwd("/Users/martijnzoodsma/Documents/PhD/corona/Postcovid-targeted-proteomics/")
load('data/data.RData')
# PCA on the Radboud and MHH cohorts combined
annot.radboud %<>% filter(time == 'W1T1')
annot <- rbind(annot.mhh %>% select(condition, cohort),
annot.radboud %>% select(condition, cohort))
df <- rbind(mhh %>% select(intersect(colnames(mhh), colnames(radboud))),
radboud %>% select(intersect(colnames(mhh), colnames(radboud))))
df <- na.omit(df)
annot <- na.omit(annot)
annot %<>% filter(rownames(annot) %in% intersect(rownames(df), rownames(annot)))
df %<>% filter(rownames(df) %in% intersect(rownames(df), rownames(annot)))
pca <- prcomp(x = df, center = T, scale. = T)
pcs <- data.frame(pca$x)
annot$condition <- factor(annot$condition, levels = c('ICU', 'non-ICU', 'postcovid', 'healthy'))
pdf('output/pca.pdf', width = 5, height = 5)
ggplot() +
geom_point(data = pcs, aes(PC1, PC2, color = annot$condition)) +
theme_classic() +
scale_color_nejm() +
labs(x = 'PC1 [27.74%]', y = 'PC2 [11.66%]', color='Condition')
dev.off()
pcs[which(pcs$PC2 > 20), ]
