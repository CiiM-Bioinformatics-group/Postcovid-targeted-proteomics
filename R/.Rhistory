# Radboud
library(openxlsx)
library(dplyr)
library(magrittr)
rm(list = ls())
load('data/data.RData')
annot <- read.xlsx('/Users/martijnzoodsma/Documents/PhD/corona/data/Nijmegen cohort/pat_info/Clinical data ALL RUMC patients (incl transfers) Castor export 220720_Correct timepoints RUMC plasma v3.xlsx')
annot <- cbind(reshape2::colsplit(annot$record_id,
pattern = '=',
names = c('RUMC', 'BERN')) %>%
select(RUMC) %>% mutate(RUMC = gsub(' ', '', RUMC)), annot)
samples <- unique(annot.radboud$pat_id)
annot %<>% filter(RUMC %in% samples)
annot.radboud <- annot.radboud %>%
filter(time == 'W1T1') %>%
arrange(match(pat_id, samples))
annot %<>% filter(RUMC %in% annot.radboud$pat_id) %>% arrange(match(RUMC, annot.radboud$pat_id))
# How many patients with presumed vs proven COVID-19 split by condition?
table(annot$w1_tp1_location, annot$COVID_confirmed)
cellcounts <- annot %>% select(colnames(annot)[grepl('adm_diff', colnames(annot))])
colnames(cellcounts) <- c('neutrophils', 'lymphocytes', 'monocytes', 'eosinophils', 'basophils')
cellcounts[cellcounts == 'Not done'] <- NA
